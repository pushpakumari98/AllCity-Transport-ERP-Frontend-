<!-- use *ngIf to mount/unmount modal so backdrop and focus are clean -->
<div *ngIf="show" class="modal-backdrop fade show" style="z-index: 1055;"></div>
<div *ngIf="show" class="modal" tabindex="-1" style="display:block; z-index: 1056;">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <form [formGroup]="employeeForm" (ngSubmit)="saveEmployee()">

        <div class="modal-header">
          <h5 class="modal-title text-center">{{ editMode ? 'Edit Employee' : 'Add ' + userType }}</h5>
          <button type="button" class="btn-close" (click)="close()"></button>
        </div>

        <div class="modal-body">
          <!-- Basic Information -->
          <h6 class="text-muted mb-3">Basic Information</h6>
          <div class="row">
            <div class="col-md-4 mb-3">
              <label class="form-label">Employee Name <span class="text-danger">*</span></label>
              <input formControlName="name" type="text" class="form-control" placeholder="Enter full name" />
            </div>

            <div class="col-md-4 mb-3">
              <label class="form-label">Contact Number</label>
              <input formControlName="contactNo" type="tel" class="form-control" placeholder="Enter phone number" />
            </div>

            <div class="col-md-4 mb-3">
              <label class="form-label">Email Address</label>
              <input formControlName="email" type="email" class="form-control" placeholder="Enter email address" />
            </div>
          </div>

          <div class="row">
            <div class="col-md-4 mb-3">
              <label class="form-label">Date of Joining <span class="text-danger">*</span></label>
              <input formControlName="dateOfJoining" type="date" class="form-control" />
            </div>

            <div class="col-md-4 mb-3">
              <label class="form-label">Designation</label>
              <input formControlName="designation" type="text" class="form-control"
                     [readonly]="(userType && (userType === 'Manager' || userType === 'Employee' || userType === 'User' || userType === 'Admin')) || (editMode && employeeData)"
                     placeholder="Enter designation" />
            </div>

            <div class="col-md-4 mb-3">
              <label class="form-label">Role <span class="text-danger">*</span></label>
              <select class="form-control" formControlName="role">
                <option [ngValue]="null">-- Select Role --</option>
                <option [ngValue]="'Team Lead'">Team Lead</option>
                <option [ngValue]="'Senior Developer'">Senior Developer</option>
                <option [ngValue]="'Developer'">Developer</option>
                <option [ngValue]="'Junior Developer'">Junior Developer</option>
                <option [ngValue]="'Manager'">Manager</option>
                <option [ngValue]="'Supervisor'">Supervisor</option>
                <option [ngValue]="'User'">User</option>
                <option [ngValue]="'Admin'">Admin</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Department</label>
              <select class="form-control" formControlName="departmentId">
                <option [ngValue]="null">-- Select Department --</option>
                <option [ngValue]="1">HR Department</option>
                <option [ngValue]="2">Sales Department</option>
                <option [ngValue]="3">Transport Department</option>
                <option [ngValue]="4">Finance Department</option>
              </select>
            </div>

            <div class="col-md-6 mb-3">
              <label class="form-label">Qualification Document</label>
              <input type="file" class="form-control" formControlName="qualificationDocument"
                     accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" (change)="onFileSelected($event)" />
              <small class="text-muted">Supported formats: PDF, DOC, DOCX, JPG, JPEG, PNG</small>
              <div *ngIf="editMode && employeeData?.qualificationDocument" class="mt-2">
                <small class="text-success">Current file: {{ employeeData.qualificationDocument }}</small>
              </div>
            </div>
          </div>

        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" (click)="close()">Cancel</button>
          <button class="btn btn-primary" type="submit">{{ editMode ? 'Update' : 'Save' }}</button>
        </div>

      </form>
    </div>
  </div>
</div>
