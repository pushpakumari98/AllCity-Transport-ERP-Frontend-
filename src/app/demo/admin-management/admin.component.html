<div class="container mt-4">
  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3>Admin Management</h3>
    <div class="d-flex align-items-center flex-wrap">
      <button type="button" class="btn btn-primary me-2 mb-1" (click)="openAddOptions()">
        <i class="fa fa-plus me-2"></i>Add
      </button>

      <button class="btn btn-info me-2 mb-1" (click)="addDepartment()">
        + Add Department
      </button>

      <div class="dropdown me-2 mb-1">
        <button type="button" class="btn btn-success dropdown-toggle" (click)="toggleExportDropdown()" [attr.aria-expanded]="showExportDropdown">
          <i class="fa fa-download me-2"></i>Export
        </button>
        <ul class="dropdown-menu" [class.show]="showExportDropdown">
          <li><a class="dropdown-item" href="#" (click)="export('csv'); showExportDropdown = false">
            <i class="fa fa-file-csv me-2"></i>CSV
          </a></li>
          <li><a class="dropdown-item" href="#" (click)="export('pdf'); showExportDropdown = false">
            <i class="fa fa-file-pdf me-2"></i>PDF
          </a></li>
          <li><a class="dropdown-item" href="#" (click)="export('excel'); showExportDropdown = false">
            <i class="fa fa-file-excel me-2"></i>Excel
          </a></li>
          <li><a class="dropdown-item" href="#" (click)="export('docx'); showExportDropdown = false">
            <i class="fa fa-file-word me-2"></i>Word (DOCX)
          </a></li>
        </ul>
      </div>

      <button type="button" class="btn btn-secondary mb-1" (click)="print()">
        <i class="fa fa-print me-2"></i>Print
      </button>
    </div>
  </div>

<!-- ADD OPTIONS MODAL -->
<div *ngIf="showAddOptionsModal" class="modal-backdrop fade show" style="z-index: 1055;"></div>
<div *ngIf="showAddOptionsModal" class="modal" tabindex="-1" style="display:block; z-index: 1056;">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Select Type to Add</h5>
        <button type="button" class="btn-close" (click)="closeAddOptionsModal()"></button>
      </div>
      <div class="modal-body">
        <div class="d-grid gap-2">
          <button type="button" class="btn btn-primary" (click)="selectAddOption('Employee')">
            <i class="fa fa-user me-2"></i>Add Employee
          </button>
          <button type="button" class="btn btn-primary" (click)="selectAddOption('User')">
            <i class="fa fa-users me-2"></i>Add User
          </button>
          <button type="button" class="btn btn-primary" (click)="selectAddOption('Manager')">
            <i class="fa fa-user-tie me-2"></i>Add Manager
          </button>
        </div>
      </div>
    </div>
  </div>
</div>


  <!-- USERS SECTION -->
  <h4 class="section-title mt-4">ðŸ‘¥ Users</h4>
  <table class="table mt-3 table-bordered" *ngIf="users.length > 0">
    <thead>
      <tr style="background-color: #e3f2fd;">
        <th class="text-center">SL.No</th>
        <th class="text-center">Name</th>
        <th class="text-center">Contact</th>
        <th class="text-center">Email</th>
        <th class="text-center">Department</th>
        <th class="text-center">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let emp of users; let i = index">
        <td class="text-center">{{ i + 1 }}</td>
        <td class="text-center">{{ emp.name }}</td>
        <td class="text-center">{{ emp.contactNo }}</td>
        <td class="text-center">{{ emp.email }}</td>
        <td class="text-center">{{ getDepartmentName(emp.departmentId) }}</td>
        <td class="text-center">
          <button class="btn btn-sm btn-warning me-2" (click)="openEdit(emp)" title="Edit User">
            <i class="fa fa-edit"></i>
          </button>
          <button class="btn btn-sm btn-danger" (click)="delete(emp)" title="Delete User">
            <i class="fa fa-trash"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <div *ngIf="users.length === 0" class="text-center py-3 mb-4" style="background-color: #f8f9ff; border-radius: 5px;">
    <h5 style="color: #666;">No users found.</h5>
    <small class="text-muted">Users added will appear here.</small>
  </div>

  <!-- MANAGERS SECTION -->
  <h4 class="section-title mt-4">ðŸ‘” Managers</h4>
  <table class="table mt-3 table-bordered" *ngIf="managers.length > 0">
    <thead>
      <tr style="background-color: #e8f5e8;">
        <th class="text-center">SL.No</th>
        <th class="text-center">Name</th>
        <th class="text-center">Contact</th>
        <th class="text-center">Email</th>
        <th class="text-center">Department</th>
        <th class="text-center">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let emp of managers; let i = index">
        <td class="text-center">{{ i + 1 }}</td>
        <td class="text-center">{{ emp.name }}</td>
        <td class="text-center">{{ emp.contactNo }}</td>
        <td class="text-center">{{ emp.email }}</td>
        <td class="text-center">{{ getDepartmentName(emp.departmentId) }}</td>
        <td class="text-center">
          <button class="btn btn-sm btn-warning me-2" (click)="openEdit(emp)" title="Edit Manager">
            <i class="fa fa-edit"></i>
          </button>
          <button class="btn btn-sm btn-danger" (click)="delete(emp)" title="Delete Manager">
            <i class="fa fa-trash"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <div *ngIf="managers.length === 0" class="text-center py-3 mb-4" style="background-color: #f8fff8; border-radius: 5px;">
    <h5 style="color: #666;">No managers found.</h5>
    <small class="text-muted">Managers added will appear here.</small>
  </div>

  <!-- EMPLOYEES SECTION -->
  <h4 class="section-title mt-4">ðŸ‘· Employees</h4>
  <table class="table mt-3 table-bordered" *ngIf="employeesList.length > 0">
    <thead>
      <tr style="background-color: #f8f4ff;">
        <th class="text-center">SL.No</th>
        <th class="text-center">Name</th>
        <th class="text-center">Contact</th>
        <th class="text-center">Email</th>
        <th class="text-center">Department</th>
        <th class="text-center">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let emp of employeesList; let i = index">
        <td class="text-center">{{ i + 1 }}</td>
        <td class="text-center">{{ emp.name }}</td>
        <td class="text-center">{{ emp.contactNo }}</td>
        <td class="text-center">{{ emp.email }}</td>
        <td class="text-center">{{ getDepartmentName(emp.departmentId) }}</td>
        <td class="text-center">
          <button class="btn btn-sm btn-warning me-2" (click)="openEdit(emp)" title="Edit Employee">
            <i class="fa fa-edit"></i>
          </button>
          <button class="btn btn-sm btn-danger" (click)="delete(emp)" title="Delete Employee">
            <i class="fa fa-trash"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <div *ngIf="employeesList.length === 0" class="text-center py-3 mb-4" style="background-color: #fcf9ff; border-radius: 5px;">
    <h5 style="color: #666;">No employees found.</h5>
    <small class="text-muted">Employees added will appear here.</small>
  </div>


</div>

<!-- EMPLOYEE MODAL -->
<app-employee-modal
  [show]="showEmployeeModal"
  [editMode]="editMode"
  [employeeData]="selectedEmployee ? selectedEmployee : null"
  [userType]="selectedUserType"
  (closeModal)="closeModal()"
  (refreshList)="load()"
  (employeeSaved)="onEmployeeSaved($event)">
</app-employee-modal>

<!-- DEPARTMENT MODAL -->
<app-department-modal
  [show]="showDepartmentModal"
  (closeModal)="closeDepartmentModal()"
  (refreshList)="load()">
</app-department-modal>

<!-- CONFIRMATION DIALOG -->
<app-confirmation-dialog
  [show]="showConfirmationDialog"
  title="Delete Employee"
  message="Are you sure you want to delete this employee? This action cannot be undone."
  confirmButtonText="Delete"
  cancelButtonText="Cancel"
  confirmButtonClass="btn-danger"
  (confirm)="onConfirmDelete()"
  (cancel)="onCancelDelete()">
</app-confirmation-dialog>
